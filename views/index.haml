!!! 5
%html
  %head
    %meta{charset: "utf-8"}
    %title Freevana :: Cuevana/Peliplay to Megaupload
    %meta{name: "description", content: "Turn your streaming links into faster Megaupload downloads"}
    %meta{name: "author", content: "Cristian Rasch"}

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    %script{src: "http://html5shim.googlecode.com/svn/trunk/html5.js"}
    <![endif]-->

    <!-- Le styles -->
    %link{href: "css/bootstrap.css", rel: "stylesheet"}
    :css
      /* Override some defaults */
      html, body {
        background-color: #eee;
      }
      body {
        padding-top: 40px; /* 40px to make the container go all the way to the bottom of the topbar */
      }
      .container > footer p {
        text-align: center; /* center align it with the container */
      }
      .container {
        width: 820px; /* downsize our container to make the content feel a bit tighter and more cohesive. NOTE: this removes two full columns from the grid, meaning you only go to 14 columns and not 16. */
      }

      /* The white background content wrapper */
      .container > .content {
        background-color: #fff;
        padding: 20px;
        margin: 0 -20px; /* negative indent the amount of the padding to maintain the grid system */
        -webkit-border-radius: 0 0 6px 6px;
           -moz-border-radius: 0 0 6px 6px;
                border-radius: 0 0 6px 6px;
        -webkit-box-shadow: 0 1px 2px rgba(0,0,0,.15);
           -moz-box-shadow: 0 1px 2px rgba(0,0,0,.15);
                box-shadow: 0 1px 2px rgba(0,0,0,.15);
      }

      /* Page header tweaks */
      .page-header {
        background-color: #f5f5f5;
        padding: 20px 20px 10px;
        margin: -20px -20px 20px;
      }

      /* Styles you shouldn't keep as they are for displaying this base example only */
      .content .span10,
      .content .span4 {
        min-height: 500px;
      }
      /* Give a quick and non-cross-browser friendly divider */
      .content .span4 {
        margin-left: 0;
        padding-left: 19px;
        border-left: 1px solid #eee;
      }

      .topbar .btn {
        border: 0;
      }

    <!-- Le fav and touch icons -->
    / %link{rel: "shortcut icon", href: "images/favicon.ico"}

  %body

    .topbar
      .fill
        .container
          %a.brand{href: "#"} Freevana
          /
            %ul.nav
              %li.active <a href="#">Home</a>
              %li <a href="#about">About</a>
              %li <a href="#contact">Contact</a>

    .container

      .content
        .page-header
          %h1 Don't stream flash videos! <small>download mp4 files directly from Megaupload :P</small>
        .row
          .span10
            %h2 Turn your streaming links into faster Megaupload HTTP downloads
            
            %h3 Supported streaming sites:
            %ul
              %li
                %a{href: 'http://www.cuevana.tv/', target: '_blank'} Cuevana
              %li
                %a{href: 'http://www.peliplay.com/', target: '_blank'} Peliplay
            
            %p.url
              URL
              %input{type: 'text', name: 'url', size: 70, id: 'url',
                     placeholder: 'http://www.cuevana.tv/peliculas/1729/ghostbusters-ghost-busters/'}
              %input{type: 'submit', class: 'btn', value: 'Download'}
              %img#wheel{src: 'images/wheel.gif'}
            
            %p.error
            
          /
            .span4
            %h3 Secondary content

      %footer
        %p 
          &copy;
          %a{href: 'https://twitter.com/#!/cristianrasch', target: '_blank'} Cristian Rasch
          = Date.today.year
    
    %script{src: "http://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js"}
    :javascript
      $('input.btn').click(function() {
        var wheel = $('#wheel')
        wheel.css('visibility', 'visible');
        var submitBtn = $(this)
        submitBtn.attr('disabled', 'disabled');
        
        $.get('index', { url: $('#url').val() }, function(data) {
          if(/http/.exec(data))
            window.location = data;
          else {
            $('.error').html(data);
            submitBtn.removeAttr('disabled');
          }
          wheel.css('visibility', 'hidden');
        });
      });
